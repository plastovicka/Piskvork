<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>Komunikace UI pøes soubory</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1250">
<META content="Specifikace starého protokolu pro piškvorkové algoritmy, které komunikují s manaerem piškvorkového turnaje pomocí souborù." name="description">
<META content="Vojta Havránek a Petr Laštovièka" name="author">
<META content=Czech name=language>
<link rel="stylesheet" type="text/css" href="styl.css">
<BODY>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-391946-1";
_udn="none"; 
_ulink=1; 
urchinTracker();
</script>

<H1>Starı protokol</H1>
<P align=center>

<script type="text/javascript"> 
document.write('<a href="javascript:__utmLinker(\'http://gomocup.org/detail-information/\');"><SPAN class=bigbutton>Zpìt na informace</SPAN></a>'); 
</script> 
<noscript> 
<A href="http://gomocup.org/detail-information/"><SPAN class=bigbutton>Zpìt na informace</SPAN></A>
</noscript> 

<BR></P><BR>
<P><EM>Tento protokol je ji zastaralı.</EM> Manaer ho sice stále 
podporuje, ale tvoøíte-li novou umìlou inteligenci, doporuèujeme vám pouít <A 
href="protocl2.htm">novı protokol</A>.</P>
<P>Umìlá inteligence (UI) komunikuje s manaerem (programem, kterı zprostøedkovává 
zápas) pøes datové soubory. Soubor PLOCHA.DAT obsahuje hrací plochu. Soubor TAH.DAT má dvì podoby. Nejdøíve obsahuje informaci o hráèi, kterı je právì na tahu, a potom obsahuje vıslednı tah UI. V souboru TIMEOUTS.DAT jsou èasové limity. Nepovinnım rozšíøením protokolu jsou soubory MSG.DAT a INFO.DAT.</P>
<P>Funguje to jednoduše a to sice:<BR><OL>
<LI>Manaer vytvoøí soubory PLOCHA.DAT, TAH.DAT, INFO.DAT, TIMEOUTS.DAT a prázdnı soubor MSG.DAT.
<LI>Manaer spustí UI a pak èeká (napøíklad pomocí funkce WaitForSingleObject).
<LI>UI si pøeète datové soubory a vymyslí svùj tah.
<LI>UI zapíše souøadnice do TAH.DAT a pøípadnì také zapíše zprávu do MSG.DAT.
<LI>UI se ukonèí.
<LI> Manaer pøeète MSG.DAT. Jestlie není prázdnı, zobrazí zprávu do logovacího okna nebo souboru. 
<LI>Manaer pøeète TAH.DAT a podle nìj provede tah. 
<LI>Pak se vše opakuje pro druhého hráèe atd.
<LI>Pøi ukonèení by manaer mìl odstranit všechny zde pouívané soubory.
</OL>
</P>
<P>Pracovní adresáø si volí manaer. UI musí poèítat s tím, e pracovní adresáø je jinı ne ten, ve kterém se nachází spustitelnı soubor UI. Jestlie tedy UI kromì EXE a DLL souborù obsahuje také ještì nìjaké datové soubory, pak se na nì musí odkazovat celou cestou. Cestu mùe UI zjistit napøíklad pomocí funkce GetModuleFileName. Druhou moností je podívat se na nultı parametr na pøíkazové øádce. Manaer musí pøi spouštìní UI na pøíkazovou øádku dát název exe souboru v takovém tvaru, aby ho UI mohla otevøít, tedy vèetnì exe pøípony a pøípadnì cesty, pokud UI neleí v pracovním adresáøi.</P>
<P>Pokud UI potøebuje ukládat na disk nìjaké soubory, pak si v pracovním adresáøi vytvoøí sloku, její název musí bıt stejnı jako název UI. V této sloce si pak UI mùe dìlat prakticky cokoli, pokud tím nepøekroèí maximální povolenou velikost, která je zveøejnìna na webovıch stránkách turnaje (nyní je 20MB). Bìhem turnaje se soubory v této sloce nemaou. Manaer mùe všechny doèasné soubory odstranit a po skonèení turnaje nebo pøi ukonèení manaeru. Pro trvalé ukládání souborù slouí sloka, její název je v souboru INFO.DAT.</P>
<P class=vetsi><EM>PLOCHA.DAT:</EM></P>
<P>Tento soubor obsahuje záznam hrací plochy. Poèet øádkù v souboru je roven vıšce hrací plochy. Poèet znakù na kadém øádku je roven šíøce hrací plochy. UI si tedy musí zjistit rozmìry hrací plochy tak, e si spoèítá, kolik má soubor øádkù a jak jsou tyto øádky dlouhé. Pøi turnaji budou pouity rozmìry 20x20. Prázdná pole jsou reprezentovaná znakem - (pomlèka, minus). Jeden hráè hraje za køíky, které jsou 
zaznamenány znakem x (malé písmeno x). Druhému hráèi pøipadají koleèka, která se 
zapisují znakem o (malé písmeno o). Pøi kontinuální høe mohou bıt nìkterá pole obsazena vıherní pìticí, tato pole se zapisují znakem # (køíek).
<BR><BR>Pøíklad souboru PLOCHA.DAT:<PRE><CODE>
---x-x--------------
----x-o---x---------
-----xxoooox--------
-----#x-o-----------
-----#xoooxo--------
-----#--x-x---------
-----#--------------
-----#-----#-------x
------o---#xoo-----o
----xooo-#----------
------xo#-----------
-------#o-----------
------#oxx----------
-----o--------------
--------------------
ooox----------------
---x----------------
-x-x----------xoo-x-
--------------------
--------------------
</CODE></PRE>
<P class=vetsi><EM>TAH.DAT:</EM></P>
<P>Ne manaer spustí nìjakou UI, zapíše do souboru TAH.DAT jeden znak (buï 
x, nebo o), co znamená za jakého hráèe má UI vymyslet tah. Kdy je tah 
vymyšlen, pøepíše UI tento soubor do formátu x,y (èíslo sloupce, èárka, èíslo øádku). To jsou souøadnice, kam chce UI umístit svùj symbol. <EM>POZOR: hodnota x i hodnota y je v rozmezí 0-19, nikoliv v rozmezí 1-20.</EM> Levı horní roh hrací plochy má souøadnice [0,0]. </P>
<P class=vetsi><EM>TIMEOUTS.DAT:</EM></P>
<P>Tento soubor obsahuje dva øádky. Na prvním øádku je èasovı limit na tah v sekundách. Nulová hodnota èasu na tah znamená, e UI má odpovìdìt pokud mono co nejdøíve (mìla by napøíklad jenom spoèítat ohodnocovací funkci a u neprohledávat do hloubky všechny moné tahy). Na druhém øádku je zbıvající èas do konce partie v milisekundách. Pokud UI pøekroèí èasovı limit, pak zbıvající èas mùe bıt zápornı. Pokud èas na partii je neomezenı, pak je na druhém øádku èíslo 2147483647.</P>
<P>Soubor TIMEOUTS.DAT obsahuje èas na tah s pøesností pouze na celé sekundy, zatímco v souboru INFO.DAT je èas na tah s pøesností na milisekundy. Bohuel nìkteré manaery vùbec nevytváøejí soubor INFO.DAT. Proto se doporuèuje, aby se UI nejdøíve pokusila otevøít soubor INFO.DAT, a jestlie tento soubor neexistuje, tak teprve pak pouívat soubor TIMEOUTS.DAT.</P>
<P class=vetsi><EM>MSG.DAT:</EM></P>
<P>UI bìhem hry mùe posílat manaeru textové zprávy, které manaer loguje (napø. pro ladìní nebo pro 
pobavení). Pøed kadım spuštìním UI manaer vytvoøí prázdnı soubor MSG.DAT. Do tohoto souboru UI zapíše jednu nebo více øádek textu. Nedoporuèuje se pouívat více øádek, protoe nìkteré manaery umìjí naèíst jen jednu øádku.
</P>
<P class=vetsi><EM>INFO.DAT:</EM></P>
<P>UI musí poèítat s tím, e starší manaery tento soubor nevytváøejí a nebo v nìm nejsou všechny zde popsané informace. Obsah tohoto souboru se mùe mìnit i v prùbìhu hry. 
Kadı øádek je ve tvaru [klíè] [hodnota].<PRE>
timeout_turn  - limit na tah (v milisekundách, 0=hraj co nejrychleji)
timeout_match - limit na zápas (v milisekundách, 0=bez limitu)
max_memory    - limit na maximální spotøebovanou pamì (v bajtech, 0=bez limitu)
time_left     - zbıvající èas do konce partie (v milisekundách)
game_type     - 0=hra proti èlovìku, 1=hra proti UI, 2=turnaj, 3=síovı turnaj
rule          - 0=pìt nebo více v øadì vyhrává, 1=pøesnì pìt v øadì vyhrává,
                2=kontinuální hra, 3=kontinuální a pøesnì pìt v øadì
folder        - sloka, kam si UI mùe zapisovat trvalé soubory
</PRE>
Sloka pro trvalé soubory je spoleèná pro všechny UI, pøípadnì i pro jiné aplikace. Proto je UI povinna si v dané sloce vytvoøit svoji podsloku, její název je stejnı jako název UI. Do ní si mùe ukládat napøíklad znalosti a zkušenosti získané bìhem hry.
<BR><BR>Pøíklad souboru INFO.DAT:
<PRE><CODE>max_memory 83886080
timeout_match 180000
timeout_turn 2500
game_type 0
rule 3
time_left 148150
folder C:\Documents and Settings\All Users\Data aplikací
</CODE></PRE></P>
</BODY></HTML>
